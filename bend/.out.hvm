@Tree/Leaf = (a (* ((a b) b)))

@Tree/Node = (a (b ((a (b c)) (* c))))

@main = h
  & @sum ~ (g h)
  & @Tree/Node ~ (c (f g))
  & @Tree/Node ~ (a (b c))
  & @Tree/Leaf ~ (1 a)
  & @Tree/Leaf ~ (2 b)
  & @Tree/Node ~ (d (e f))
  & @Tree/Leaf ~ (3 d)
  & @Tree/Leaf ~ (4 e)

@sum = a
  & @sum__fold0 ~ a

@sum__fold0 = ((@sum__fold0__C0 ((a a) b)) b)

@sum__fold0__C0 = (a (b d))
  &! @sum__fold0 ~ (a $(:[+] $(c d)))
  &! @sum__fold0 ~ (b c)